---
title: GC-垃圾回收1
date: 2021-1-18 14:32:00
tags:
top:
password:
description:
img:
---
# 什么是GC
GC指计算机中自动管理内存的机制。当程序占用的一部分内存空间不再被这个程序访问时，这个程序通过GC向操作系统归还这部分内存空间。

在C/C++中没有GC,需要手动分配，回收内存，这就要求开发人员要对资源的释放有较高的要求，也容易导致出现错误。在Lisp最先出现垃圾回收，目前使用GC的有Jvm, .net等。
# GC的必要性

# GC常用策略
## 引用计数(Reference Count)
引用计数是计算机语言中一种内存管理的技术。指将资源的引用次数保存起来，当要创建对象或者其他地方要持有当前对象时，该对象的引用次数加1，当要释放一个对象时该对象的引用次数就减1，直到引用次数为0时，就将该对象释放掉。
### 优点
与下面的追踪方式相比不需要进行对应用程序的挂起，标记，删除，再继续执行应用程序的过程，可以同时运行程序与资源管理，尽快的回收不再使用的资源，不会出现长时间的等待。
### 缺点
1. 原始的引用技术方式会出现循环引用的问题。
2. 频繁的更新引用计数会导致降低运行效率。
## 追踪(Tracing)
在计算机中，追踪垃圾回收是一种动态回收垃圾的算法。从“根”节点进行遍历，标记处可以访问到的资源，然后将不可达对象所占用的内存进行回收的操作。
### 对象的可达性
从"根"节点出发，能够直接或者间接访问到的对象就叫可达对象。
### 弱引用与强引用
`弱引用`指使对象不受垃圾回收的保护。通俗的讲就是不管有没有出现引用，只要执行了垃圾回收就回收掉。

### 标记-删除算法(mark-sweep)
1. 挂起程序线程执行下面操作
2. `mark` 从"根节点"进行遍历，标记所有可达资源。
3. `sweep` 对标记的可达资源取消标记，对没有标记的资源进行内存回收。
4. 回收完毕继续执行程序线程

### 为什么这里垃圾回收线程无法与程序线程同时执行？


# 优点：
1. 可以解决循环引用的问题